# Заготовка пустого проекта на Django
Проект сделан на основе приведенной ниже последовательности действий и примеров кода из раздела D3.2. Знакомство с django.views.
Использован код от начала страницы и до большого смайлика.
При обновлении страницы http://127.0.0.1:8000/products/ вместо списка товаров показывает пустую страницу со следующим кодом:
```
<!--  наследуемся от шаблона default.html, который мы создавали ещё во времена flatpages -->
<!DOCTYPE html>
<html>
<head>
<title></title>
</head>
<body>

</body>
</html>
```

При этом по ссылке http://127.0.0.1:8000/new_app/ показывается текст страницы, созданной в админке.

Хочется понять, где именно проблема, что пропущено, из-за чего не срабатывает шаблон.

---------
# Создаем пустой проект Django
Если вы работаете на Windows, то проблем быть не должно, просто пишем в терминале в корне той папки, в которой хотим создать виртуальное окружение следующую строку:

`python3 -m venv venv`

Если вы на линуксе, то, скорее всего, вам понадобится дополнительно установить Python виртуальное окружение, это делается просто:

`sudo apt-get install -y python3-venv`

И после вводим ту же команду, что и на Windows. После чего у вас в корне должна появится папка venv. Это и есть наше виртуальное окружение.

Активируем его:

Windows:

`venv\scripts\activate`

Linux/MacOS:

`source venv/bin/activate`

Перейдя в виртуальное окружение, мы теперь работаем с изолированной версией Python, которая находится у нас в папке venv и не имеет никакого отношения к глобально установленному интерпретатору и модулям.

Теперь установим Django так же, как предлагают это сделать в документации, но с активированной средой:

`pip3 install django`

Ждём окончания установки.
ВНИМАНИЕ: Django установился у нас в виртуальную среду. Это означает следующее: мы можем работать с ним только, пока мы находимся в этой среде. Если вы забудете её активировать перед тем, как приступите к работе с проектом, менеджер Django вам об этом любезно напомнит.

После установки Django создаём пустой проект:

`django-admin startproject project`

Мы даём команду только что установленному модулю django-admin создать новый проект с именем project. После того как команда выполнится, у вас создастся пустой проект.
В этом проекте пока нет ничего кроме папки с основными элементами проекта и файла manage.py, который нас сейчас больше всего и интересует. С этим файлом мы как раз будем работать, когда будем запускать наш проект, изменять структуру базы данных и т. д. 
Давайте запустим наш пустой проект и посмотрим, что он нам выдаст.

Переходим в папку project в нашем терминале или cmd (если вы на Windows) и прописываем:

`python3 manage.py runserver`

Теперь мы можем увидеть сообщение, что наше веб-приложение готово к работе. Открываем любой браузер и переходим по адресу http://127.0.0.1:8000/. Вместо 127.0.0.1 можете также прописать localhost, разницы никакой нет. И то, и то указывает на адрес локальной машины, где у нас и крутится наш собственный Django-сервер.

## Пустой Django-проект готов.


# Добавляем приложение к проекту
Переходим в директорию проекта:

`(venv) ~/django-projects $ cd NewsPaper`

Здесь мы видим замечательный файл manage.py, который является точкой входа для управления проектом. Также через консоль запустим следующую команду, которая создаст новое приложение news.

`(venv) ~/django-projects/NewsPaper $ python3 manage.py startapp news`

Здесь мы использовали команду startapp из скрипта manage.py. В качестве параметра этой команды мы должны указать название нового приложения — news. Мы можем увидеть новую директорию, в которой есть большое количество файлов.
Django автоматически создал основные необходимые файлы для нового приложения. Чтобы это приложение стало частью этого проекта, мы должны его добавить в установленные приложения.
Перейдём в файл NewsPaper/settings.py и найдём там список INSTALLED_APPS:
Здесь мы должны добавить новый элемент в этот список — строку с названием приложения, которое совпадает с названием директории. Это позволит Django обнаружить созданное нами приложение.
Найдём там список INSTALLED_APPS и аккуратно добавим в него наши плоские странички и сайты. Дело в том, что изначально эти приложения отключены. Оно и понятно: не в каждом веб-приложении нужны просто статические странички, но нам нужны. Поэтому их надо подключить, дополнительно немножко потрудившись.

В итоге список должен выглядеть примерно так:

```python
INSTALLED_APPS = [
    'django.contrib.admin',
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.messages',
    'django.contrib.staticfiles',
    
    # подключаем ещё приложения
    'django.contrib.sites',
    'django.contrib.flatpages',
]
```

После чего спустимся ниже в файле и добавим переменную SITE_ID, равную единице.

`SITE_ID = 1`

После чего нам надо будет сделать так, чтобы адреса в будущем написанных нами страничках были доступны нам для перехода по ним.
Изменим наш файл urls.py, лежащий в той же папке. Это нужно для того, чтобы добавились ссылки на наши странички (ко всем страничкам доступ будет автоматический, но, чтобы они работали, нужно добавить их сюда).

```python
"""project URL Configuration
 
The 'urlpatterns' list routes URLs to views. For more information please see:
    https://docs.djangoproject.com/en/3.1/topics/http/urls/
Examples:
Function views
    1. Add an import:  from my_app import views
    2. Add a URL to urlpatterns:  path('', views.home, name='home')
Class-based views
    1. Add an import:  from other_app.views import Home
    2. Add a URL to urlpatterns:  path('', Home.as_view(), name='home')
Including another URLconf
    1. Import the include() function: from django.urls import include, path
    2. Add a URL to urlpatterns:  path('blog/', include('blog.urls'))
"""
from django.contrib import admin
from django.urls import path, include
 
urlpatterns = [
    path('admin/', admin.site.urls),
    path('pages/', include('django.contrib.flatpages.urls')),
]
```

Вернёмся в настройки и слегка изменим список MIDDLEWARE. Что это такое и зачем нужно, сейчас спрашивать лучше не стоит. Но если кратко, то middleware — это нечто вроде декораторов, которые применяются к абсолютно любой ссылке в нашем веб-приложении и также могут менять её поведение. Мы ещё будем про них говорить, но намного позже. Просто поменяйте свой список на следующий:

```python
MIDDLEWARE = [
    'django.middleware.security.SecurityMiddleware',
    'django.contrib.sessions.middleware.SessionMiddleware',
    'django.middleware.common.CommonMiddleware',
    'django.middleware.csrf.CsrfViewMiddleware',
    'django.contrib.auth.middleware.AuthenticationMiddleware',
    'django.contrib.messages.middleware.MessageMiddleware',
    'django.middleware.clickjacking.XFrameOptionsMiddleware',
 
    'django.contrib.flatpages.middleware.FlatpageFallbackMiddleware', 
]
```

Теперь перед тем, как создавать странички, нам надо создать админа.

Админ — это главный пользователь веб-приложения.

Создать админа очень просто. Надо ввести команду в терминале в той папке, где лежит у нас manage.py, т. к. обращаться мы будем именно к нему.

`python3 manage.py makemigrations`

`python manage.py migrate`

Сейчас мы подготовили нашу базу данных для создания админа. Давайте создадим же его наконец!

`python manage.py createsuperuser`

Далее назначаем ему имя, пароль на свой вкус и цвет. Адрес электронной почты можете оставить пустым, если хотите.

Запускаем сервер:

`python manage.py runserver`

Перейдя по знакомому адресу, мы видим, что приветливое сообщение пропало, потому что наш проект теперь не совсем пустой. Ну что ж, мы будем по нему скучать. Давайте перейдём в админку http://127.0.0.1:8000/admin/ .

Здесь, если вы сделали всё правильно, после логина через админа, которого мы только что создали, должны появится все модели нашего приложения, которые мы можем создать. Нажмём на зелёный «+» и создадим новую страничку для нашего сайта.
Здесь мы видим несколько полей:

        URL — адрес нашей странички;
        Title — название, которое будет во вкладке браузера;
        Content — HTML-код который будет отображаться на страничке.

Advanced options мы раскроем чуть попозже.
Нажимаем save. В директории с файлом manage.py надо создать файл по следующему пути: templates/flatpages/default.html. Иначе Django просто не поймёт, где именно искать шаблон.

Содержание файла должно быть следующим:

```html
<!DOCTYPE html>
<html>
<head>
<title>{{ flatpage.title }}</title>
</head>
<body>
{{ flatpage.content }}
</body>
</html>
```

Теперь мы создали нашу первую HTML-страничку! Поздравляем вас!

Вот и всё, теперь переходим по ссылке и видим наше детище в браузере.
Если по какой-то причине у вас появляется ошибка, что шаблон default.html не найден, просто поменяйте список TEMPLATES в настройках на следующий (не забудьте импортировать модуль os):

```python
TEMPLATES = [
    {
        'BACKEND': 'django.template.backends.django.DjangoTemplates',
        'DIRS': [os.path.join(BASE_DIR, 'templates')],
        'APP_DIRS': True,
        'OPTIONS': {
            'context_processors': [
                'django.template.context_processors.debug',
                'django.template.context_processors.request',
                'django.contrib.auth.context_processors.auth',
                'django.contrib.messages.context_processors.messages',
            ],
        },
    },
]
```

После чего всё должно заработать.